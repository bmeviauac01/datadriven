
<!doctype html>
<html lang="hu" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Albert István, Tóth Tibor">
      
      
        <link rel="canonical" href="https://bmeviauac01.github.io/datadriven/hu/lecture-notes/mssql/sql/">
      
      
        <link rel="prev" href="../../transactions/">
      
      
        <link rel="next" href="../server-side-programming/">
      
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.9">
    
    
      
        <title>SQL nyelv, MSSQL platformfüggő SQL utasítások - BMEVIAUAC01 Adatvezérelt rendszerek</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.78cf6014.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../extra-material-theme.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sql-nyelv-mssql-platformfuggo-sql-utasitasok" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Élőfej">
    <a href="../../.." title="BMEVIAUAC01 Adatvezérelt rendszerek" class="md-header__button md-logo" aria-label="BMEVIAUAC01 Adatvezérelt rendszerek" data-md-component="logo">
      
  <img src="../../../img/logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUAC01 Adatvezérelt rendszerek
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SQL nyelv, MSSQL platformfüggő SQL utasítások
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red"  aria-label="Váltás sötét témára"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Váltás sötét témára" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Váltás világos témára"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Váltás világos témára" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Nyelvváltás">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="https://bmeviauac01.github.io/datadriven/en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="https://bmeviauac01.github.io/datadriven/hu/" hreflang="hu" class="md-select__link">
              Magyar
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Keresés">
        
        <button type="reset" class="md-search__icon md-icon" title="Törlés" aria-label="Törlés" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Keresés inicializálása
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bmeviauac01/datadriven" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviauac01/datadriven
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Lapok" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Adatvezérelt rendszerek

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../db/" class="md-tabs__link">
          
  
  Adatbázis

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../architecture/" class="md-tabs__link">
          
  
  Jegyzetek

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../seminar/transactions/" class="md-tabs__link">
          
  
  Gyakorlatok

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../homework/" class="md-tabs__link">
          
  
  Házi feladatok

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigáció" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="BMEVIAUAC01 Adatvezérelt rendszerek" class="md-nav__button md-logo" aria-label="BMEVIAUAC01 Adatvezérelt rendszerek" data-md-component="logo">
      
  <img src="../../../img/logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUAC01 Adatvezérelt rendszerek
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bmeviauac01/datadriven" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviauac01/datadriven
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adatvezérelt rendszerek
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Adatbázis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Adatbázis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minta adatbázis sémája
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/mssql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microsoft SQL Server használata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../db/mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB használata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://raw.githubusercontent.com/bmeviauac01/datadriven/master/overrides/db/mssql.sql" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minta adatbázis: mssql.sql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://raw.githubusercontent.com/bmeviauac01/datadriven/master/overrides/db/mongo.js" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minta adatbázis: mongo.js
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Jegyzetek
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Jegyzetek
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adatvezérelt rendszerek és a többrétegű (háromrétegű) architektúra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../transactions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tranzakciókezelés adatbázisokban
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    SQL nyelv, MSSQL platformfüggő SQL utasítások
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    SQL nyelv, MSSQL platformfüggő SQL utasítások
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#egyszeru-lekerdezesek" class="md-nav__link">
    <span class="md-ellipsis">
      Egyszerű lekérdezések
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablak-osszekapcsolasa" class="md-nav__link">
    <span class="md-ellipsis">
      Táblák összekapcsolása
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rendezes" class="md-nav__link">
    <span class="md-ellipsis">
      Rendezés
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allekerdezesek" class="md-nav__link">
    <span class="md-ellipsis">
      Allekérdezések
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#duplikatum-szurese" class="md-nav__link">
    <span class="md-ellipsis">
      Duplikátum szűrése
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oszlopfuggvenyek" class="md-nav__link">
    <span class="md-ellipsis">
      Oszlopfüggvények
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rekordok-letrehozasa" class="md-nav__link">
    <span class="md-ellipsis">
      Rekordok létrehozása
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rekordok-modositasa" class="md-nav__link">
    <span class="md-ellipsis">
      Rekordok módosítása
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rekordok-torlese" class="md-nav__link">
    <span class="md-ellipsis">
      Rekordok törlése
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sorszamozas" class="md-nav__link">
    <span class="md-ellipsis">
      Sorszámozás
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cte-common-table-expression" class="md-nav__link">
    <span class="md-ellipsis">
      CTE (Common Table Expression)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xml-dokumentumok-lekerdezese" class="md-nav__link">
    <span class="md-ellipsis">
      XML dokumentumok lekérdezése
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XML dokumentumok lekérdezése">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xpath" class="md-nav__link">
    <span class="md-ellipsis">
      XPath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lekerdezesek" class="md-nav__link">
    <span class="md-ellipsis">
      Lekérdezések
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manipulalo-lekerdezesek" class="md-nav__link">
    <span class="md-ellipsis">
      Manipuláló lekérdezések
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../server-side-programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microsoft SQL Server programozása
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../adonet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ADO.NET adatelérés
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../linq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LINQ: Language Integrated Query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ef/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kapcsolatok definiálása Entity Framework-ben
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB alapok, műveletek, és a MongoDB .NET Driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL_Cheat_Sheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lekérdezés szintaktitka cheat-sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../di/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Függőséginjektálás ASP.NET Core környezetben
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../async/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aszinkron kérések és DTO-k (példa WebAPI alkalmazás)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../openapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenAPI 3 és a Swagger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../restapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST API (Gyakorló példák)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/bmeviauac01/rest-webapi-sample" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST és WebAPI demó alkalmazás (GitHub)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/bmeviauac01/todoapi-di-sample" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ASP.NET Core DI demó alkalmazás (GitHub)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/bmeviauac01/threelayered-aspnetcore-sample" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Minta többrétegű webalkalmazás (GitHub)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Gyakorlatok
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Gyakorlatok
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../seminar/transactions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tranzakciókezelés
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../seminar/mssql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microsoft SQL Server programozása
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../seminar/ef/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entity Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../seminar/mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../seminar/jpa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JPA & Spring Data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../seminar/rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    REST API & ASP.NET Web API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Házi feladatok
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Házi feladatok
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Szorgalmi házi feladatok
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/mssql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feladat: MSSQL szerveroldali programozás
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/adonet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feladat: ADO.NET adatelérés
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/ef/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feladat: Entity Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feladat: MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feladat: REST API Web API technológiával
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/GitHub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feladatok beadása (GitHub)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/GitHub-Actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Actions ismertető
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../homework/VisualStudio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visual Studio & .NET SDK telepítése
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#egyszeru-lekerdezesek" class="md-nav__link">
    <span class="md-ellipsis">
      Egyszerű lekérdezések
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablak-osszekapcsolasa" class="md-nav__link">
    <span class="md-ellipsis">
      Táblák összekapcsolása
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rendezes" class="md-nav__link">
    <span class="md-ellipsis">
      Rendezés
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#allekerdezesek" class="md-nav__link">
    <span class="md-ellipsis">
      Allekérdezések
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#duplikatum-szurese" class="md-nav__link">
    <span class="md-ellipsis">
      Duplikátum szűrése
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#oszlopfuggvenyek" class="md-nav__link">
    <span class="md-ellipsis">
      Oszlopfüggvények
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rekordok-letrehozasa" class="md-nav__link">
    <span class="md-ellipsis">
      Rekordok létrehozása
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rekordok-modositasa" class="md-nav__link">
    <span class="md-ellipsis">
      Rekordok módosítása
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rekordok-torlese" class="md-nav__link">
    <span class="md-ellipsis">
      Rekordok törlése
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sorszamozas" class="md-nav__link">
    <span class="md-ellipsis">
      Sorszámozás
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cte-common-table-expression" class="md-nav__link">
    <span class="md-ellipsis">
      CTE (Common Table Expression)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xml-dokumentumok-lekerdezese" class="md-nav__link">
    <span class="md-ellipsis">
      XML dokumentumok lekérdezése
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XML dokumentumok lekérdezése">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xpath" class="md-nav__link">
    <span class="md-ellipsis">
      XPath
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lekerdezesek" class="md-nav__link">
    <span class="md-ellipsis">
      Lekérdezések
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manipulalo-lekerdezesek" class="md-nav__link">
    <span class="md-ellipsis">
      Manipuláló lekérdezések
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/bmeviauac01/datadriven/blob/master/docs/hu/lecture-notes/mssql/sql.md" title="Oldal szerkesztése" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="sql-nyelv-mssql-platformfuggo-sql-utasitasok">SQL nyelv, MSSQL platformfüggő SQL utasítások<a class="headerlink" href="#sql-nyelv-mssql-platformfuggo-sql-utasitasok" title="Permanent link">&para;</a></h1>
<p>A példák a <a href="../../../db/">minta adatbázison</a> futtathatóak.</p>
<h2 id="egyszeru-lekerdezesek">Egyszerű lekérdezések<a class="headerlink" href="#egyszeru-lekerdezesek" title="Permanent link">&para;</a></h2>
<p>Melyik termék olcsóbb mint 2000 és kevesebb, mint 50 db van belőle?</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Price</span><span class="p">,</span><span class="w"> </span><span class="n">Stock</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">where</span><span class="w"> </span><span class="n">Price</span><span class="o">&lt;</span><span class="mi">2000</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">Stock</span><span class="o">&lt;</span><span class="mi">50</span>
</code></pre></div>
<p>Melyik termékhez nincs leírás?</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">where</span><span class="w"> </span><span class="n">Description</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">null</span>
</code></pre></div>
<h2 id="tablak-osszekapcsolasa">Táblák összekapcsolása<a class="headerlink" href="#tablak-osszekapcsolasa" title="Permanent link">&para;</a></h2>
<p>Budapesti központi telephellyel rendelkező vevők (a két megoldás ekvivalens)</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="k">c</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerSite</span><span class="w"> </span><span class="n">s</span>
<span class="k">where</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">MainCustomerSiteID</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">ID</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">City</span><span class="o">=</span><span class="s1">&#39;Budapest&#39;</span>

<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Customer</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">CustomerSite</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">MainCustomerSiteID</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">ID</span>
<span class="k">where</span><span class="w"> </span><span class="n">City</span><span class="o">=</span><span class="s1">&#39;Budapest&#39;</span>
</code></pre></div>
<p>Listázza ki az M betűvel kezdődő termékek nevét és a megrendelt mennyiségeket úgy, hogy azok a termékek is benne legyenek a listában melyekből nem rendeltek meg semmit</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="k">Sum</span><span class="p">(</span><span class="n">oi</span><span class="p">.</span><span class="n">Amount</span><span class="p">)</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">p</span>
<span class="w">     </span><span class="k">left</span><span class="w"> </span><span class="k">outer</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">OrderItem</span><span class="w"> </span><span class="n">oi</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="n">oi</span><span class="p">.</span><span class="n">ProductID</span>
<span class="k">where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;M%&#39;</span>
<span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Name</span>
</code></pre></div>
<h2 id="rendezes">Rendezés<a class="headerlink" href="#rendezes" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span>
</code></pre></div>
<p>Microsoft SQL Server specifikus: <em>collation</em> a rendezés szabályait adja meg</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="k">collate</span><span class="w"> </span><span class="n">SQL_Latin1_General_Cp1_CI_AI</span>
</code></pre></div>
<p>Több mező szerinti rendezés</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Stock</span><span class="w"> </span><span class="k">desc</span><span class="p">,</span><span class="w"> </span><span class="n">Price</span>
</code></pre></div>
<h2 id="allekerdezesek">Allekérdezések<a class="headerlink" href="#allekerdezesek" title="Permanent link">&para;</a></h2>
<p>Listázzuk ki a megrendelések dátumát, határidejét és Status-át</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="nb">Date</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">Deadline</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Name</span>
<span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="k">Order</span><span class="p">]</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">StatusId</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">ID</span>
</code></pre></div>
<p>Alternatív, de nem ekvivalens megoldás: az allekérdezés az outer joinnak felel meg!</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="nb">Date</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">Deadline</span><span class="p">,</span>
<span class="w">       </span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">Name</span>
<span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="n">Status</span><span class="w"> </span><span class="n">s</span>
<span class="w">        </span><span class="k">where</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">StatusId</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">ID</span><span class="p">)</span>
<span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="k">Order</span><span class="p">]</span><span class="w"> </span><span class="n">o</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title"><code>[Order]</code></p>
<p>Az <code>[Order]</code> azért szerepel szögletes zárójelben, mert így jelöljük, hogy ez egy tábla neve, és nem az <code>order by</code> parancs kezdete.</p>
</div>
<h2 id="duplikatum-szurese">Duplikátum szűrése<a class="headerlink" href="#duplikatum-szurese" title="Permanent link">&para;</a></h2>
<p>Melyek azok a termékek, melyből egyszerre több, mint 3 db-ot rendeltek? Ugyanabból a termékből több alkalommal is előfordulhatott, de csak egyszer szeretnénk a nevét látni.</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="k">distinct</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Name</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">OrderItem</span><span class="w"> </span><span class="n">oi</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">oi</span><span class="p">.</span><span class="n">ProductID</span><span class="o">=</span><span class="n">p</span><span class="p">.</span><span class="n">ID</span>
<span class="k">where</span><span class="w"> </span><span class="n">oi</span><span class="p">.</span><span class="n">Amount</span><span class="o">&gt;</span><span class="mi">3</span>
</code></pre></div>
<h2 id="oszlopfuggvenyek">Oszlopfüggvények<a class="headerlink" href="#oszlopfuggvenyek" title="Permanent link">&para;</a></h2>
<p>Mennyibe kerül a legdrágább termék?</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">Price</span><span class="p">)</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
</code></pre></div>
<p>Melyek a legdrágább termékek?</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">where</span><span class="w"> </span><span class="n">Price</span><span class="o">=</span><span class="p">(</span><span class="k">select</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">Price</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Product</span><span class="p">)</span>
</code></pre></div>
<p>Azon termékeket min, max és átlag mennyiért adták el, melyek nevében szerepel a Lego és az átlag eladási áruk 10.000-nél nagyobb</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="k">min</span><span class="p">(</span><span class="n">oi</span><span class="p">.</span><span class="n">Price</span><span class="p">),</span><span class="w"> </span><span class="k">max</span><span class="p">(</span><span class="n">oi</span><span class="p">.</span><span class="n">Price</span><span class="p">),</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">oi</span><span class="p">.</span><span class="n">Price</span><span class="p">)</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">p</span>
<span class="w">     </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">OrderItem</span><span class="w"> </span><span class="n">oi</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">ID</span><span class="o">=</span><span class="n">oi</span><span class="p">.</span><span class="n">ProductID</span>
<span class="k">Where</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Lego%&#39;</span>
<span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Name</span>
<span class="k">having</span><span class="w"> </span><span class="k">avg</span><span class="p">(</span><span class="n">oi</span><span class="p">.</span><span class="n">Price</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10000</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">2</span>
</code></pre></div>
<h2 id="rekordok-letrehozasa">Rekordok létrehozása<a class="headerlink" href="#rekordok-letrehozasa" title="Permanent link">&para;</a></h2>
<p>Egy rekord létrehozása minden oszlop (kivéve <em>identity</em>) adatának megadásával</p>
<div class="highlight"><pre><span></span><code><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">Product</span>
<span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
</code></pre></div>
<p>Csak megnevezett oszlopok értékeinek kitöltése</p>
<div class="highlight"><pre><span></span><code><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="n">Price</span><span class="p">)</span>
<span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<p>Lekérdezés eredményeinek beszúrása</p>
<div class="highlight"><pre><span></span><code><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Price</span><span class="p">)</span>
<span class="k">select</span><span class="w"> </span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">Price</span>
<span class="k">from</span><span class="w"> </span><span class="n">InvoiceItem</span>
<span class="k">where</span><span class="w"> </span><span class="n">Amount</span><span class="o">&gt;</span><span class="mi">2</span>
</code></pre></div>
<p>MSSQL specifikus: identity oszlop</p>
<div class="highlight"><pre><span></span><code><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">VAT</span>
<span class="p">(</span>
<span class="w">   </span><span class="n">ID</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">identity</span><span class="w"> </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">,</span>
<span class="w">   </span><span class="n">Percentage</span><span class="w"> </span><span class="nb">int</span>
<span class="p">)</span>

<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">VAT</span><span class="p">(</span><span class="n">Percentage</span><span class="p">)</span>
<span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>

<span class="k">select</span><span class="w"> </span><span class="o">@@</span><span class="k">identity</span>
</code></pre></div>
<p>MSSQL specifikus: értékadás <em>identity</em> oszlopnak</p>
<div class="highlight"><pre><span></span><code><span class="k">set</span><span class="w"> </span><span class="n">identity_insert</span><span class="w"> </span><span class="n">VAT</span><span class="w"> </span><span class="k">on</span>

<span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">VAT</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Percentage</span><span class="p">)</span>
<span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="mi">27</span><span class="p">)</span>

<span class="k">set</span><span class="w"> </span><span class="n">identity_insert</span><span class="w"> </span><span class="n">VAT</span><span class="w"> </span><span class="k">off</span>
</code></pre></div>
<h2 id="rekordok-modositasa">Rekordok módosítása<a class="headerlink" href="#rekordok-modositasa" title="Permanent link">&para;</a></h2>
<p>A Legók árát emeljük meg 10%-kal és a raktárkészletünket 5 db-bal</p>
<div class="highlight"><pre><span></span><code><span class="k">update</span><span class="w"> </span><span class="n">Product</span>
<span class="k">set</span><span class="w"> </span><span class="n">Price</span><span class="o">=</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">*</span><span class="n">Price</span><span class="p">,</span>
<span class="w">    </span><span class="n">Stock</span><span class="o">=</span><span class="n">Stock</span><span class="o">+</span><span class="mi">5</span>
<span class="k">where</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="s1">&#39;%Lego%&#39;</span>
</code></pre></div>
<p>Módosítás, ha kapcsolódó tábla alapján kell szűrni: emeljük meg 10%-kal azon 20%-os ÁFA kulcsú termékek árát, melyből, több mint 10 db van raktáron</p>
<div class="highlight"><pre><span></span><code><span class="k">update</span><span class="w"> </span><span class="n">Product</span>
<span class="k">set</span><span class="w"> </span><span class="n">Price</span><span class="o">=</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">*</span><span class="n">Price</span>
<span class="k">where</span><span class="w"> </span><span class="n">Stock</span><span class="o">&gt;</span><span class="mi">10</span>
<span class="k">and</span><span class="w"> </span><span class="n">VATID</span><span class="w"> </span><span class="k">in</span>
<span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="n">ID</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">VAT</span>
<span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">Percentage</span><span class="o">=</span><span class="mi">20</span>
<span class="p">)</span>
</code></pre></div>
<p>MSSQL Server specifikus szintaktika az előzőre</p>
<div class="highlight"><pre><span></span><code><span class="k">update</span><span class="w"> </span><span class="n">Product</span>
<span class="k">set</span><span class="w"> </span><span class="n">Price</span><span class="o">=</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="o">*</span><span class="n">Price</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">p</span>
<span class="w">     </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">VAT</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">VATID</span><span class="o">=</span><span class="n">v</span><span class="p">.</span><span class="n">ID</span>
<span class="k">where</span><span class="w"> </span><span class="n">Stock</span><span class="o">&gt;</span><span class="mi">10</span>
<span class="w">      </span><span class="k">and</span><span class="w"> </span><span class="n">Percentage</span><span class="o">=</span><span class="mi">20</span>
</code></pre></div>
<h2 id="rekordok-torlese">Rekordok törlése<a class="headerlink" href="#rekordok-torlese" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">delete</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="o">&gt;</span><span class="mi">10</span>
</code></pre></div>
<h2 id="sorszamozas">Sorszámozás<a class="headerlink" href="#sorszamozas" title="Permanent link">&para;</a></h2>
<p>Sorszámozás egy adott rendezés szerint</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="o">*</span><span class="p">,</span>
<span class="w">       </span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">r</span><span class="p">,</span>
<span class="w">       </span><span class="n">dense_rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">dr</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">p</span>
</code></pre></div>
<p>Sorszámozás csoportosításonként</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="o">*</span>
<span class="w">       </span><span class="p">,</span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">CategoryID</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">r</span>
<span class="w">       </span><span class="p">,</span><span class="n">dense_rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="n">partition</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">CategoryID</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">dr</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">p</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Rank és dense_rank</p>
<p>A dense_rank-tól eltérően a rank kihagy sorszámokat az egyenlő helyezés után. Az átugrott sorszámok száma attól függ, hogy hány sor kapott azonos rangot. Például Mary és Lisa ugyanannyi terméket adott el, így mindkettő sorszáma 1. A rank-kal a következő sorszám a 3, míg dense_rank esetén a következő sorszám a 2.</p>
</div>
<h2 id="cte-common-table-expression">CTE (Common Table Expression)<a class="headerlink" href="#cte-common-table-expression" title="Permanent link">&para;</a></h2>
<p>Motiváció: allekérdezéssel nehezen áttekinthetővé válnak a lekérdezések</p>
<p>ABC sorrendben melyik az első három termék</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span>
<span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="o">*</span>
<span class="w">            </span><span class="p">,</span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">r</span>
<span class="w">            </span><span class="p">,</span><span class="n">dense_rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">dr</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">Product</span><span class="w"> </span><span class="n">p</span>
<span class="p">)</span><span class="w"> </span><span class="n">a</span>
<span class="k">where</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">dr</span><span class="o">&lt;=</span><span class="mi">3</span>
</code></pre></div>
<p>Ugyan az a lekérdezés CTE használatával</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span><span class="w"> </span><span class="n">q1</span>
<span class="k">as</span>
<span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">            </span><span class="p">,</span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">r</span>
<span class="w">            </span><span class="p">,</span><span class="n">dense_rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">dr</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="p">)</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">q1</span>
<span class="k">where</span><span class="w"> </span><span class="n">q1</span><span class="p">.</span><span class="n">dr</span><span class="o">&lt;=</span><span class="mi">3</span>
</code></pre></div>
<p>Hány darabot adtak el a második legdrágább termékből?</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span><span class="w"> </span><span class="n">q</span>
<span class="k">as</span>
<span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="n">dense_rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Price</span><span class="w"> </span><span class="k">desc</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">dr</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="p">)</span>
<span class="k">select</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="k">sum</span><span class="p">(</span><span class="n">Amount</span><span class="p">)</span>
<span class="k">from</span><span class="w"> </span><span class="n">q</span>
<span class="w">     </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">OrderItem</span><span class="w"> </span><span class="n">oi</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">oi</span><span class="p">.</span><span class="n">ProductID</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">ID</span>
<span class="k">where</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">dr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">Name</span>
</code></pre></div>
<p>Lapozás: termékek listázása ABC sorrendben a 3. rekordól a 8. rekordig</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span><span class="w"> </span><span class="n">q</span>
<span class="k">as</span>
<span class="p">(</span>
<span class="w">    </span><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="p">()</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">r</span>
<span class="w">    </span><span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="p">)</span>
<span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">q</span>
<span class="k">where</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">r</span><span class="w"> </span><span class="k">between</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="mi">8</span>
</code></pre></div>
<p>Lapozás: MSSQL Server (2012+) specifikus megoldás</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span>
<span class="k">offset</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span>
<span class="k">fetch</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">only</span>

<span class="k">select</span><span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">Name</span>
</code></pre></div>
<h2 id="xml-dokumentumok-lekerdezese">XML dokumentumok lekérdezése<a class="headerlink" href="#xml-dokumentumok-lekerdezese" title="Permanent link">&para;</a></h2>
<p>Egy relációs adatbázisban a relációs adatok mellett félig strukturált adatokat (pl.: XML) is eltárolhatunk, viszont a relációs a fő tartalom. A <a href="../../../db/">minta adatbázisban</a> a <code>Product</code> tábla <code>Description</code> mezője XML formátumú.</p>
<h3 id="xpath">XPath<a class="headerlink" href="#xpath" title="Permanent link">&para;</a></h3>
<p>Egy XML dokumentum fa struktúrájú. Az <a href="https://www.w3schools.com/xml/xpath_intro.asp"><strong>XPath</strong></a> nyelv segítségével navigálhatunk a fában és kiválaszthatunk csomópontokat megadott szűrési szempontok alapján. Az alábbi táblázat szemlélteti az <em>XPath</em> nyelv működését és képességeit</p>
<table>
<thead>
<tr>
<th><strong>XPath kifejezés</strong></th>
<th><strong>Jelentés</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>tagnév</td>
<td>Csomópont névvel megadva</td>
</tr>
<tr>
<td>/</td>
<td>A gyökértől kezdődik a keresés</td>
</tr>
<tr>
<td>//</td>
<td>Aktuális csomóponttól kezdve bármely leszármazottban</td>
</tr>
<tr>
<td>.</td>
<td>Aktuális csomópont</td>
</tr>
<tr>
<td>..</td>
<td>Szülő csomópont</td>
</tr>
<tr>
<td>@nev</td>
<td>Adott nevű attribútum</td>
</tr>
<tr>
<td>/konyvtar/konyv[k]</td>
<td>A k. konyv gyerek a konyvtar elemen belül (1-től kezdődik az indexelés)</td>
</tr>
<tr>
<td>/konyvtar/konyv[last()]</td>
<td>Utolsó gyerek</td>
</tr>
<tr>
<td>/konyvtar/konyv[position()&lt;k]</td>
<td>Az első k-1 gyerek</td>
</tr>
<tr>
<td>//cim[@nyelv="hu"]</td>
<td>Azok a cim elemek, amelyeknek van "hu" értékű nyelv attribútuma</td>
</tr>
<tr>
<td>//cim[text()]</td>
<td>A cim elemek szövege (a tag-ek közötti rész)</td>
</tr>
<tr>
<td>/konyvtar/konyv[ar&gt;5000]</td>
<td>Azok a konyvtar elemek belüli konyv elemek, amelyeknek az ar gyereke legalább 5000</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">XQuery és XPath</p>
<p>Az <em>XPath</em> a fentiek mellett még sok más képességgel is rendelkezik, sokkal bonyolultabb lekérdezésekre is képes.</p>
<p>A további példákban <a href="https://docs.microsoft.com/en-us/sql/t-sql/xml/xml-data-modification-language-xml-dml"><em>XQuery</em></a> nyelvet használva fogjuk megadni a lekérdezendő adatokat. Az <em>XQuery</em> az <em>XPath</em>-re épül és egészíti ki azt további funkciókkal. Mind az <em>XPath</em>, mind az <em>XQuery</em> platformfüggetlen, W3C standardokra épülő nyelv.</p>
</div>
<h3 id="lekerdezesek">Lekérdezések<a class="headerlink" href="#lekerdezesek" title="Permanent link">&para;</a></h3>
<p>Adott tehát egy olyan tábla, amiben van egy XML típusú mező. Amellett, hogy a mező teljes értékét lekérdezhetjük, a tartalmára is képesek vagyunk lekérdezéseket megfogalmazni. Az XML dokumentumokban való lekérdezéshez az XML adattípuson definiált <a href="https://docs.microsoft.com/en-us/sql/t-sql/xml/query-method-xml-data-type"><code>query(XQuery)</code></a>, <a href="https://docs.microsoft.com/en-us/sql/t-sql/xml/value-method-xml-data-type"><code>value(XQuery, SQLType)</code></a> és <a href="https://docs.microsoft.com/en-us/sql/t-sql/xml/exist-method-xml-data-type"><code>exist(XQuery)</code></a> T-SQL függvényt használhatjuk. Nézzünk ezekre pár példát.</p>
<p>Kérdezzük le, hogy hány csomagból állnak a termékek!</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">Description</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;/product/package_parameters/number_of_packages&#39;</span><span class="p">)</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
</code></pre></div>
<p>Ennek az eredménye például a következő lehet:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;number_of_packages&gt;</span>1<span class="nt">&lt;/number_of_packages&gt;</span>
</code></pre></div>
<p>A <code>query()</code> XML-lel tér vissza, ha csak az értékre van szükség, akkor a <code>value()</code> metódust használhatjuk. A <code>value()</code> metódusnak meg kell adni a lekérdezett adat típusát is string literálként.</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">Description</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;(/product/package_parameters/number_of_packages)[1]&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
</code></pre></div>
<p>Ennek az eredménye már az 1 lesz számként.</p>
<div class="admonition info">
<p class="admonition-title">SQLType</p>
<p>A paraméterként átadott típus nem lehet xml. A megadott típusra való konvertálás T-SQL <a href="https://docs.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql"><code>CONVERT</code></a> függvénnyel történik.</p>
</div>
<p>Kérdezzük le azoknak a termékeknek a nevét, amelyek a 0-18 hónapos korosztálynak ajánlottak.</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">Name</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">where</span><span class="w"> </span><span class="n">Description</span><span class="p">.</span><span class="n">exist</span><span class="p">(</span><span class="s1">&#39;(/product)[(./recommended_age)[1] eq &quot;0-18 m&quot;]&#39;</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
</code></pre></div>
<p>Az <code>exist()</code> 1-gyel tér vissza, ha a megadott <em>XQuery</em> kifejezéssel futtatott lekérdezés nem üres eredménnyel tér vissza; vagy 0-val, amennyiben a lekérdezés eredménye üres.</p>
<p>A lekérdezést <code>exist()</code> helyett <code>value()</code> metódus segítségével is megfogalmazhatjuk.</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span><span class="w"> </span><span class="n">Name</span>
<span class="k">from</span><span class="w"> </span><span class="n">Product</span>
<span class="k">where</span><span class="w"> </span><span class="n">Description</span><span class="p">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;(/product/recommended_age)[1]&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;varchar(max)&#39;</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;0-18 m&#39;</span>
</code></pre></div>
<h3 id="manipulalo-lekerdezesek">Manipuláló lekérdezések<a class="headerlink" href="#manipulalo-lekerdezesek" title="Permanent link">&para;</a></h3>
<p>Nem csak lekérdezni tudunk XML adatokat, hanem módosítani is. A módosítás az adatbázisban atomi módon történik, azaz nem kell kliens oldalra letölteni az XML-t, módosítani, majd visszatölteni. Helyette a szerveroldali programozás filozófiáját követve a logikát (itt: módosítás) visszük az adatbázisba. Az adatmódosító lekérdezéseket a <a href="https://docs.microsoft.com/en-us/sql/t-sql/xml/modify-method-xml-data-type"><code>modify(XML_DML)</code></a> függvénnyel hajthatjuk végre, ahol is az ún. <a href="https://docs.microsoft.com/en-us/sql/t-sql/xml/xml-data-modification-language-xml-dml">XML DML</a> nyelven kell megfogalmaznunk a módosításunkat. Nézzünk erre is pár példát.</p>
<p>Az Lego City harbour nevű terméknél az ajánlott életkort írjuk át 6-99 évre.</p>
<div class="highlight"><pre><span></span><code><span class="k">update</span><span class="w"> </span><span class="n">Product</span>
<span class="k">set</span><span class="w"> </span><span class="n">Description</span><span class="p">.</span><span class="k">modify</span><span class="p">(</span>
<span class="s1">&#39;replace value of (/product/recommended_age/text())[1]</span>
<span class="s1">with &quot;6-99 y&quot;&#39;</span><span class="p">)</span>
<span class="k">where</span><span class="w"> </span><span class="n">Name</span><span class="o">=</span><span class="s1">&#39;Lego City harbour&#39;</span>
</code></pre></div>
<p>A megadandó kifejezés két részből áll: az elsőben (<code>replace value of</code>) kell a módosítani kívánt elemet kell kiválasztani, a másodikban (<code>with</code>) az új értéket kell megadni. Egy XML-en belül csak egy elem módosítható, így az útvonalat úgy kell megadni, hogy csak egy elemre illeszkedjen - ezért szerepel példában a végén az <code>[1]</code>.</p>
<p>Szúrjunk be a Lego City harbour termékhez a <code>package_size</code> tag után egy <code>weight</code> tag-et a súly megadására.</p>
<div class="highlight"><pre><span></span><code><span class="k">update</span><span class="w"> </span><span class="n">Product</span>
<span class="k">set</span><span class="w"> </span><span class="n">Description</span><span class="p">.</span><span class="k">modify</span><span class="p">(</span>
<span class="s1">&#39;insert &lt;weight&gt;2.28&lt;/weight&gt;</span>
<span class="s1">after (/product/package_parameters/package_size)[1]&#39;</span><span class="p">)</span>
<span class="k">where</span><span class="w"> </span><span class="n">Name</span><span class="o">=</span><span class="s1">&#39;Lego City harbour&#39;</span>
</code></pre></div>
<p>A megadandó kifejezés itt is két részből áll: az elsőben (<code>insert</code>) kell megadni az új elemet, másodikban kell leírni azt, hogy hova szúrja be az új elemet. Az új elemet fel lehet venni a megadott elem testvéreként vagy gyerekeként.</p>
<p>Töröljük minden termék leírásából a <code>description</code> tag(ek)-et.</p>
<div class="highlight"><pre><span></span><code><span class="k">update</span><span class="w"> </span><span class="n">Product</span>
<span class="k">set</span><span class="w"> </span><span class="n">Description</span><span class="p">.</span><span class="k">modify</span><span class="p">(</span><span class="s1">&#39;delete /product/description&#39;</span><span class="p">)</span>
<span class="k">where</span><span class="w"> </span><span class="n">Description</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span>
</code></pre></div>
<p>A törlésnél a <code>delete</code> után meg kell adni a törlendő elemek útvonalát.</p>

    <hr>
  <div class="md-source-file">
    <span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg
          xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
          </path>
        </svg>
      </span>
      <span title="2023. november 17. 08:57:58">
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2023-11-17T08:57:58+01:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-11-17</span>
      </span>
    </span>

    

    <span class="md-source-file__fact">
      <span class="md-icon" title="Szerzők">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
          </path>
        </svg>
      </span>
      <span>Szerzők</span>
      <nav><a href="https://github.com/abdullahmusa" target="_blank" rel="noopener noreferrer" class="md-author" title="@None">
          <img src="https://avatars.githubusercontent.com/u/63659188?v=4?size=72" alt="@None">
        </a><a href="https://github.com/akosdudas" target="_blank" rel="noopener noreferrer" class="md-author" title="@Akos Dudas">
          <img src="https://avatars.githubusercontent.com/u/11335181?u=9971512094b94810046de53f5c1dee78e9776a4f&v=4?size=72" alt="@Akos Dudas">
        </a><a href="https://github.com/botondklenk" target="_blank" rel="noopener noreferrer" class="md-author" title="@None">
          <img src="https://avatars.githubusercontent.com/u/60361254?u=890a9fadbfa6aaeceef12c64716631bc0fa6f228&v=4?size=72" alt="@None">
        </a><a href="https://github.com/gergoradeczki" target="_blank" rel="noopener noreferrer" class="md-author" title="@Gergő Radeczki">
          <img src="https://avatars.githubusercontent.com/u/4851436?u=6af920525ee593810b1e7973750e169c5f69b71c&v=4?size=72" alt="@Gergő Radeczki">
        </a><a href="https://github.com/MarcellHarmaci" target="_blank" rel="noopener noreferrer" class="md-author" title="@Marcell Harmaci">
          <img src="https://avatars.githubusercontent.com/u/47602777?u=3047b02cf404fbfbbd991af770b9dea28d876178&v=4?size=72" alt="@Marcell Harmaci">
        </a><a href="https://github.com/meszarosp" target="_blank" rel="noopener noreferrer" class="md-author" title="@Péter Mészáros">
          <img src="https://avatars.githubusercontent.com/u/57116193?v=4?size=72" alt="@Péter Mészáros">
        </a><a href="https://github.com/Szofficsok" target="_blank" rel="noopener noreferrer" class="md-author" title="@None">
          <img src="https://avatars.githubusercontent.com/u/79463616?v=4?size=72" alt="@None">
        </a><a href="https://github.com/tanaiadam" target="_blank" rel="noopener noreferrer" class="md-author" title="@None">
          <img src="https://avatars.githubusercontent.com/u/65241679?u=f6e7535ece7ea2ea6c0602364470b48a22b3524c&v=4?size=72" alt="@None">
        </a></nav>      
    </span>
  </div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Vissza a tetejére
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; BME VIK AUT
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest", "content.action.edit"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>